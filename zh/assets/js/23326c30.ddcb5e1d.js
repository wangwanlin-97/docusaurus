"use strict";(self.webpackChunkwechaty_docusaurus=self.webpackChunkwechaty_docusaurus||[]).push([[1375],{3905:(e,t,a)=>{a.d(t,{Zo:()=>l,kt:()=>d});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var i=r.createContext({}),s=function(e){var t=r.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):p(p({},t),e)),a},l=function(e){var t=s(e.components);return r.createElement(i.Provider,{value:t},e.children)},u="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},y=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,i=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),u=s(a),y=n,d=u["".concat(i,".").concat(y)]||u[y]||h[y]||o;return a?r.createElement(d,p(p({ref:t},l),{},{components:a})):r.createElement(d,p({ref:t},l))}));function d(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,p=new Array(o);p[0]=y;var c={};for(var i in t)hasOwnProperty.call(t,i)&&(c[i]=t[i]);c.originalType=e,c[u]="string"==typeof e?e:n,p[1]=c;for(var s=2;s<o;s++)p[s]=a[s];return r.createElement.apply(null,p)}return r.createElement.apply(null,a)}y.displayName="MDXCreateElement"},68023:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>i,contentTitle:()=>p,default:()=>h,frontMatter:()=>o,metadata:()=>c,toc:()=>s});var r=a(87462),n=(a(67294),a(3905));const o={title:"Architecture"},p=void 0,c={unversionedId:"explanations/architecture",id:"explanations/architecture",title:"Architecture",description:"Puppet Structure",source:"@site/docs/explanations/architecture.md",sourceDirName:"explanations",slug:"/explanations/architecture",permalink:"/zh/docs/explanations/architecture",draft:!1,editUrl:"https://github.com/wechaty/docusaurus/edit/main/docusaurus/docs/explanations/architecture.md",tags:[],version:"current",lastUpdatedBy:"Huan",lastUpdatedAt:1631298410,formattedLastUpdatedAt:"2021\u5e749\u670810\u65e5",frontMatter:{title:"Architecture"},sidebar:"docs",previous:{title:"Concepts",permalink:"/zh/docs/explanations/concepts"},next:{title:"Alternatives",permalink:"/zh/docs/explanations/alternatives"}},i={},s=[],l={toc:s},u="wrapper";function h(e){let{components:t,...o}=e;return(0,n.kt)(u,(0,r.Z)({},l,o,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Puppet Structure",src:a(31819).Z,width:"1668",height:"363"})),(0,n.kt)("p",null,"When building a chatbot, the choice of architecture model used is informed primarily by the core purpose of the project. In the Wechaty ecosystem, there are several interrelated and interdependent components that constitute a chatbot. Highlighted below are some of these key components. It is important to understand them and how they fit together to take full advantage of the features offered by the Wechaty ecosystem."),(0,n.kt)("p",null,"The following diagram shows out that we can reuse almost everything in TypeScript, and what we need to do is only the block located at the top right of the diagram: ",(0,n.kt)("inlineCode",{parentName:"p"},"Wechaty (Polyglot)"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-ascii"},"  +--------------------------+ +--------------------------+\n  |                          | |                          |\n  |   Wechaty (TypeScript)   | |    Wechaty(Polyglot)     |\n  |                          | |  Python, Go, Rust, etc.  |\n  +--------------------------+ +--------------------------+\n\n  +-------------------------------------------------------+\n  |                 Wechaty Puppet Service                |\n  |                                                       |\n  |                (wechaty-puppet-service)               |\n  +-------------------------------------------------------+\n\n+---------------------  wechaty_grpc  ----------------------+\n\n  +-------------------------------------------------------+\n  |                   Wechaty Puppet                      |\n  |                                                       |\n  |                   (wechaty-puppet)                    |\n  +-------------------------------------------------------+\n\n  +--------------------------+ +--------------------------+\n  |      Pad Protocol        | |      Web Protocol        |\n  |                          | |                          |\n  | wechaty-puppet-padlocal  | |  (wechaty-puppet-wechat) |\n  +--------------------------+ +--------------------------+\n  +--------------------------+ +--------------------------+\n  |     Friday Protocol      | |       Mac Protocol       |\n  |                          | |                          |\n  |  (wechaty-puppet-frida)  | |   (wechaty-puppet-mac)   |\n  +--------------------------+ +--------------------------+\n")),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"Chart made by ",(0,n.kt)("a",{parentName:"p",href:"http://asciiflow.com/"},"AsciiFlow"))),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Instant Messaging platforms")),(0,n.kt)("p",{parentName:"li"},"With Wechaty, you can build chatbots for Instant Messaging systems such as Wechat and Whatsapp among others. They constitute the front-end interface your clients will interact with. One prominent advantage Wechaty has over other SDKs is that you write code once and use the same code for all Instant Messaging platforms. Your source code should work for different IM service tokens without making any changes to the codebase. What is required is just switching the service token and environment variable ",(0,n.kt)("inlineCode",{parentName:"p"},"WECHATY_PUPPET"),".")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Wechaty Puppet")),(0,n.kt)("p",{parentName:"li"},"Wechaty Puppet is a standard for maintaining compatibility between Instant Messaging(IM) systems. Wechaty Puppet defines the universal Instant Messaging interface for compatibility between Wechaty API and variants of IM systems.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Wechaty Puppet Providers")),(0,n.kt)("p",{parentName:"li"},"Wechaty puppet provider refers to RPA module used for connecting Wechaty API to the corresponding Instant Messaging platform bot account. Each supported Instant Messaging system has its own Puppet provider. See ",(0,n.kt)("a",{parentName:"p",href:"/zh/docs/puppet-providers/"},"Puppet Providers")," section for a complete list of puppet providers."),(0,n.kt)("p",{parentName:"li"},"For example, the Wechaty Puppet Provider for WeChat is ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/wechaty/wechaty-puppet-wechat"},"wechaty-puppet-wechat"),", that for Whatsapp is ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/wechaty/wechaty-puppet-whatsapp"},"wechaty-puppet-whatsapp"),", and for Lark is ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/wechaty/wechaty-puppet-lark"},"wechaty-puppet-lark"),".")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Wechaty Puppet Service")),(0,n.kt)("p",{parentName:"li"},"Wechaty Puppet Service is gRPC for Wechaty Puppet Provider. For example, we can cloudify the Wechaty Puppet Provider wechaty-puppet-padlocal to a Wechaty Puppet Service by running our Wechaty Puppet Service Token Gateway.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Wechaty gRPC")),(0,n.kt)("p",{parentName:"li"},"Initially, Wechaty was built using TypeScript. Support for other languages such as Python, Go, Java, PHP, .NET, and Scala was later introduced in 2020 so that chatbot makers can build chatbots in their preferred language. This version of Wechaty which offers multi-language support is referred to as ",(0,n.kt)("strong",{parentName:"p"},"Wechaty polyglot"),". The introduction of Wechaty polyglot however came with its challenges because all Wechaty puppet providers were built using TypeScript and delivered via npm. Translating all of them to the languages supported by Wechaty polyglot was a monumental challenge. To solve this problem, Wechaty gRPC was created. The goal of Wechaty RPC is to ",(0,n.kt)("em",{parentName:"p"},"cloudify")," Wechaty Puppet Providers. It ensures we can use the Wechaty Puppet Providers remotely via network and Polyglot Wechaty can use the Wechaty Puppet API from the TypeScript ecosystem."))))}h.isMDXComponent=!0},31819:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/architecture-ef4e78c0bf9d9b359328f3de8751ebb1.png"}}]);